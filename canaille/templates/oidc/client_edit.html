{#
.. screenshot:: |canaille|/admin/client/edit/client
   :context: admin
   :align: right
   :width: 275px

   The client addition page.

The client edition template.

Displays a form to edit a :class:`~canaille.oidc.basemodels.Client`.

:param form: The client creation form.
:type form: :class:`~canaille.oidc.endpoints.forms.ClientAddForm`.
:param client: The edited client.
:type client: :class:`~canaille.oidc.basemodels.Client`
#}
{% extends theme('base.html') %}
{% import 'macro/form.html' as fui %}

{%- block title -%}
    {%- trans %}Edit an application{% endtrans -%}
{%- endblock -%}

{% block script %}
    <script src="{{ url_for("static", filename="js/copy.js") }}" defer></script>
{% endblock %}

{% block submenu %}
    <a class="active item" href="{{ url_for('oidc.clients.index') }}">
        <i class="th list icon"></i>
        {% trans %}Applications{% endtrans %}
    </a>
    <a class="item" href="{{ url_for('oidc.tokens.index') }}">
        <i class="key icon"></i>
        {% trans %}Tokens{% endtrans %}
    </a>
{% endblock %}

{% block content %}

    <div class="ui segment">
        <h2 class="ui center aligned header">
            {% trans %}Management token{% endtrans %}
        </h2>
        <p>
            {% trans %}This token can be used to edit the application details through the OAuth 2.0 Dynamic Client Registration Management Protocol.{% endtrans %}
            <a href="https://datatracker.ietf.org/doc/html/rfc7592">{% trans %}Read moreâ€¦{% endtrans %}</a>
        </p>
        {% call fui.render_form(form) %}
            <div class="ui fluid action input">
                <input type="text" value="{{ management_token }}" readonly class="copy-text" id="management-token" data-copy="management-token">
                <button type="submit" class="ui teal right labeled icon button copy-button" name="action" value="new-management-token" id="new-management-token">
                    <i class="redo icon"></i>
                    {% trans %}Renew{% endtrans %}
                </button>
                <button type="button" class="ui primary right labeled icon button copy-button" data-copy="management-token">
                    <i class="copy icon"></i>
                    {% trans %}Copy{% endtrans %}
                </button>
            </div>
        {% endcall %}
    </div>

    <div class="ui segment">
        <h2 class="ui center aligned header">
            {% trans %}Edit an application{% endtrans %}
            {% if client.trusted %}
                <span class="ui teal label" title="{% trans %}The domain of this application is trusted and thus it bypasses user consent{% endtrans %}">
                    <i class="shield alternate icon"></i>
                    {% trans %}Trusted{% endtrans %}
                </span>
            {% endif %}
        </h2>

        <div class="ui form">
            <form id="readonly">
                <div class="field">
                    <label>{% trans %}ID{% endtrans %}</label>
                    <div class="ui fluid action input">
                        <input type="text" value="{{ client.client_id }}" readonly class="copy-text" id="client-id" data-copy="client-id" name="client_id">
                        <button type="button" class="ui primary right labeled icon button copy-button" data-copy="client-id">
                            <i class="copy icon"></i>
                            {% trans %}Copy{% endtrans %}
                        </button>
                    </div>
                </div>
                <div class="field">
                    <label>{% trans %}Secret{% endtrans %}</label>
                    <div class="ui fluid action input">
                        <input type="text" value="{{ client.client_secret }}" readonly class="copy-text" id="client-secret" data-copy="client-secret" name="client_secret">
                        <button type="button" class="ui primary right labeled icon button copy-button" data-copy="client-secret">
                            <i class="copy icon"></i>
                            {% trans %}Copy{% endtrans %}
                        </button>
                    </div>
                </div>
                <div class="field">
                    <label>{% trans %}Issued at{% endtrans %}</label>
                    <div class="ui cornor labeled input">
                        <input type="text" value="{{ client.client_id_issued_at }}" readonly name="client_id_issued_at">
                        <div class="ui corner label" title="{{ _("This field is not editable") }}">
                            <i class="lock icon"></i>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        {% call fui.render_form(form, csrf=false) %}
            {{ fui.render_fields(form) }}

            <div class="ui right aligned container">
                <div class="ui stackable buttons">
                    <button type="submit" class="ui right floated button" name="action" value="new-access-token" id="new-access-token">
                        {{ _("New access token") }}
                    </button>
                    <button type="submit" class="ui right floated negative basic button confirm" name="action" value="confirm-delete" id="confirm-delete" formnovalidate>
                        {{ _("Delete the client") }}
                    </button>
                    <button type="submit" class="ui right floated primary button" name="action" value="edit" id="edit">
                        {{ _("Edit") }}
                    </button>
                </div>
            </div>
        {% endcall %}
    </div>
{% endblock %}
