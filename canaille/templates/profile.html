{% extends 'base.html' %}
{% import 'fomanticui.j2' as sui %}
{% import 'flask.j2' as flask %}

{% block script %}
    <script src="/static/js/profile.js"></script>
{% endblock %}

{% block content %}
{% if user.moderator and edited_user %}
<div class="ui basic modal">
    <div class="ui icon header">
        <i class="user minus icon"></i>
        {% trans %}User deletion{% endtrans %}
    </div>
    <div class="content">
        <p>{{ _("Are you sure you want to delete this user? This action is unrevokable and all the data about this user will be removed.") }}</p>
    </div>
    <div class="actions">
        <div class="ui inverted cancel button">{% trans %}Cancel{% endtrans %}</div>
        <div class="ui inverted red approve button">{% trans %}Delete{% endtrans %}</div>
    </div>
</div>
{% endif %}

<div class="ui clearing segment">
    <h2 class="ui center aligned header">
        <div class="content">
            {% if not edited_user %}
                {% trans %}User creation{% endtrans %}
            {% elif user.uid == edited_user.uid %}
                {% trans %}My profile{% endtrans %}
            {% else %}
                {% trans %}User profile edition{% endtrans %}
            {% endif %}

        </div>
        <div class="sub header">
            {% if not edited_user %}
                {% trans %}Create a new user account{% endtrans %}
            {% elif user.uid == edited_user.uid %}
                {% trans %}Edit your personal informations{% endtrans %}
            {% else %}
                {% trans %}Edit informations about an user{% endtrans %}
            {% endif %}
        </div>
    </h2>

    <form method="POST"
      id="{{ form.__class__.__name__|lower }}"
      action="{{ request.url }}"
      role="form"
      enctype="multipart/form-data"
      class="ui form"
      >

        {{ flask.messages() }}

        {{ sui.render_field(form.csrf_token) }}

        <h4 class="ui dividing header">{% trans %}Personal information{% endtrans %}</h4>
        <div class="two fields">
            {{ sui.render_field(form.given_name) }}
            {{ sui.render_field(form.family_name) }}
        </div>
        {{ sui.render_field(form.email) }}
        {{ sui.render_field(form.phone_number) }}

        <h4 class="ui dividing header">{% trans %}Account information{% endtrans %}</h4>
        {{ sui.render_field(form.sub) }}
        <div class="two fields">
            {{ sui.render_field(form.password1) }}
            {{ sui.render_field(form.password2) }}
        </div>

        <button type="submit" class="ui right floated primary button" name="action" value="edit" id="edit">
            {{ _("Send") }}
        </button>
        {% if user.moderator and edited_user %}
        <button type="submit" class="ui right floated negative button confirm" name="action" value="delete" id="delete">
            {{ _("Delete the user") }}
        </button>
        {% endif %}
    </form>
</div>
{% endblock %}
