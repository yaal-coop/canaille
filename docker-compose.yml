---
version: "3"

services:
  ldap:
    image: osixia/openldap
    environment:
      - LDAP_DOMAIN=mydomain.tld
    volumes:
      - ./docker/bootstrap.ldif:/container/service/slapd/assets/config/bootstrap/ldif/custom/50-boostrap.ldif:ro
      - ./schemas/oauth2-openldap.ldif:/container/service/slapd/assets/config/bootstrap/ldif/custom/40-oauth2.ldif:ro
    command: --copy-service
    ports:
      - 5389:389
      - 5636:636

  oauth:
    build:
      context: .
      dockerfile: docker/Dockerfile
    ports:
      - 5000:5000
    volumes:
      - .:/app
